{{ define "main" }}
{{ $home := .Site.GetPage "page" "home" }}
<div class="page-content">
    <!-- Hero -->
    <section class="homepage-hero">
        <div class="hero-content">
            {{ with $home.Params.hero_logo }}
            <div class="hero-logo">
                {{ partial "cisf-logo.svg" . }}
            </div>
            {{ end }}
            {{ with $home.Params.hero_subtitle }}
            <p class="hero-subtitle">{{ . }}</p>
            {{ end }}
        </div>
    </section>

    <!-- Sponsors -->
    {{ $home := .Site.GetPage "page" "home" }}
    {{ $cat := $home.Params.sponsor_category }}
    {{ if $cat }}
    <section class="homepage-sponsors">
        <h2>I nostri partner</h2>
        <div class="sponsor-scroll">
            {{ $partners := where (where $.Site.RegularPages "Section" "partners") "Params.category" $cat }}
            {{ range $partners }}
            <div class="sponsor-card">
                {{ $partner := . }}
                {{ with .Params.logo }}
                <img src="{{ . | relURL }}" alt="{{ $partner.Title }} logo" />
                {{ end }}
            </div>
            {{ end }}
        </div>
    </section>
    {{ end }}


    <!-- About -->
    <section id="about" class="homepage-about">
        <div class="about-container">
            <div class="about-text">
                <h2>{{ $home.Params.about_title }}</h2>
                {{ $home.Params.about_text | markdownify }}
            </div>
            {{ with $home.Params.about_image }}
            <div class="about-image">
                <img src="{{ . | relURL }}" alt="About image">
            </div>
            {{ end }}
        </div>
    </section>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const tl = gsap.timeline({ defaults: { ease: "power2.out" } });
        const cisLetters = document.querySelectorAll("#CIS path");
        const phi = document.querySelectorAll("#phi");

        tl.from("#Leaf_sx", { x: -100, opacity: 0, duration: 1 })
            .from("#Leaf_dx", { x: 100, opacity: 0, duration: 1 }, "<");

        // 1) CISF + glow effect
        tl.from([cisLetters, phi], {
            scale: 0,
            opacity: 0,
            transformOrigin: "center center",
            duration: 0.4,
            stagger: 0.2,
            ease: "back.out(2)"
        })
            .to([cisLetters, phi], {
                filter: "drop-shadow(0 0 10px #ff8c00)",
                duration: 0.3,
                stagger: 0.2
            }, "<")
            .to([cisLetters, phi], {
                filter: "drop-shadow(0 0 0px #ff8c00)",
                duration: 0.4,
                stagger: 0.2
            });


        // 2) ROMA
        tl.from("#roma_text", { y: -50, opacity: 0, duration: 0.8 }, "-=0.3");

        // 3) 2026
        tl.from("#new_year", {
            y: 0,
            opacity: 0,
            duration: 0.8
        }, "-=0.3");
    });
</script>
{{ end }}